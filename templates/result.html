<!DOCTYPE html>
<html>
<head>
    <title>Election Results</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            background: #f4f6f9;
        }
    </style>
</head>

<body>

<div class="container mt-5">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary">üó≥Ô∏è Election Results</h2>
        <a href="/logout" class="btn btn-danger">Logout</a>
    </div>

    {% if max_votes > 0 %}
    <div class="alert alert-success text-center fw-bold fs-5">
        üéâ Election Completed Successfully! <br>
        Congratulations to the Winner!
    </div>
    {% endif %}

    <!-- Chart -->
    <div class="card shadow p-4 mb-4">
        <canvas id="resultChart"></canvas>
    </div>

    <!-- Result Table -->
    <div class="card shadow p-4">
        <table class="table table-bordered text-center">
            <thead class="table-dark">
                <tr>
                    <th>Candidate Name</th>
                    <th>Total Votes</th>
                </tr>
            </thead>
            <tbody>
            {% for c in candidates %}
                <tr class="{% if c[2] == max_votes and max_votes > 0 %}table-success fw-bold{% endif %}">
                    <td>
                        {{ c[1] }}
                        {% if c[2] == max_votes and max_votes > 0 %}
                            üèÜ <span class="badge bg-success">WINNER</span>
                        {% endif %}
                    </td>
                    <td>{{ c[2] }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

</div>

<script>
    const labels = [{% for c in candidates %}"{{ c[1] }}",{% endfor %}];
    const data = [{% for c in candidates %}{{ c[2] }},{% endfor %}];

    new Chart(document.getElementById('resultChart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Votes',
                data: data,
                borderWidth: 1
            }]
        }
    });
</script>

</body>
</html>
